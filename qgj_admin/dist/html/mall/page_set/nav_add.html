<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit"><!--360让它显示webkit内核-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>导航设置</title>

    <link rel="stylesheet" href="../../../css/bootstrap.css">
    <script src="../../../js/lib/lib.min.js"></script>
    <script src="../../../js/lib/dateranger.min.js"></script>
    <script src="../../../js/lib/layer/layer.js"></script>
    <script src="../../../js/common/util.js"></script>
    <script src="../../../js/lib/select2.min.js"></script>
    <script src="../../../js/lib/template-web.js"></script>
    <script src="../../../js/lib/jquery-ui.min.js"></script>
    <script src="../../../js/common/common.js"></script>

    <link rel="stylesheet" href="../../../js/lib/uploadify/uploadify.css">
    <script src="../../../js/lib/uploadify/jquery.uploadify.min.js"></script>

    <!--[if lt IE 9]>
    <script src="../../../js/lib/ie8.js"></script>
    <![endif]-->
</head>
<body>

<div class="siderbar" id="siderbar">
    <div class="logo"><img src="../../../img/logo.png"> </div>
    <ul class="list-group list-group-black">
        <li><a href="../../index/index.html" class="list-group-item"><i class="icon-home h5"></i> 首页</a></li>
        <li><a href="../../store/store/store_list.html" class="list-group-item"><i class="icon-merchant"></i> 门店</a></li>
        <li><a href="../../finance/finance_flow.html" class="list-group-item"><i class="icon-finance"></i> 财务</a></li>
        <li><a href="../../crm/user/user_list.html" class="list-group-item"><i class="icon-crm"></i> CRM</a></li>
        <li><a href="../../marketing/market/market_list.html" class="list-group-item"><i class="icon-marketing"></i> 营销</a></li>
        <li><a href="../../channel/menu/menu.html" class="list-group-item"><i class="icon-channel"></i> 渠道</a></li>
        <li><a href="../../channel/menu/menu.html" class="list-group-item"><i class="icon-service"></i> 客服</a></li>
        <li><a href="../goods/good_list.html" class="list-group-item active"><i class="icon-shop"></i> 商城</a></li>
        <li><a href="../../statistics/outline.html" class="list-group-item"><i class="icon-statistics"></i> 统计</a></li>
        <li><a href="../../system/system/modify_password.html" class="list-group-item"><i class="icon-system"></i> 设置</a></li>
        <li class="affix"><a href="../../login/login.html" class="list-group-item"><i class="icon-loginout"></i> 退出</a></li>
    </ul>
</div>

<div class="main-con"><!--main-siderbar-hide隐藏二级加这个样式-->
    <div class="main-siderbar " id="mSiderbar">
        <div class="title">商城管理</div>
        <ul class="list-group list-group-gray-lighter">
            <li>
                <a href="banner_list.html" class="list-group-item active">页面管理</a>
            </li>
            <li>
                <a href="../goods/good_list.html" class="list-group-item">商品管理</a>
            </li>
            <li>
                <a href="../group/group_list.html" class="list-group-item">商品分组</a>
            </li>
            <li>
                <a href="../order/order_list.html" class="list-group-item">订单管理</a>
            </li>
            <li>
                <a href="../marketing/promotion_list.html" class="list-group-item">营销活动</a>
            </li>
            <li>
                <a href="../set/deliveries/delivery_list.html" class="list-group-item">商城设置</a>
            </li>
        </ul>
    </div>
    <div class="main-content" id="mainContent">
        <div class="m-title">
            <ul>
                <li><a href="mall_list.html">商城页面</a></li>
                <li><a href="group_list.html">分组页面</a></li>
                <li class="active"><a href="nav_add.html">导航页面</a></li>
            </ul>
        </div>
        <div class="m-content">
            <form id="mallSetForm">
                <div class="mall-set nav-set">
                    <!--左边部分-->
                    <div class="ms-prview js-ms-prview">
                        <div class="ms-title js-ms-title">
                            <span>页面名称</span>
                        </div>
                        <div class="ms-bd js-nav-set-l">
                            <!--左边模板-->
                            <script id="navSetL" type="text/html">
                                <ul class="footer navSetL-{{list.length}}" style="background-color:{{colors[0].color}}">
                                {{each list value}}
                                    <li>
                                        <a href="{{value.url}}">
                                            <div class="img">
                                                {{if value.src}}<img src="{{value.src}}" />{{/if}}
                                            </div>
                                            <span style="color:{{colors[1].color}}">{{value.title}}</span>
                                        </a>
                                    </li>
                                {{/each}}
                                </ul>
                            </script>
                        </div>

                        <!--左侧的数据存储-->
                        <input type="hidden" value="" class="hiddenData hidden-navApply">
                        <input type="hidden" value="" class="hiddenData hidden-navSet">
                    </div>
                    <!--右边部分-->
                    <div class="ms-form">
                        <div class="text-right mb10"><a href="javascript:;" class="btn btn-default js-nav-reset">重置为默认设置</a></div>
                        <dl class="nav-checkbox">
                            <dt>将导航应用到以下页面：</dt>
                            <dd class="navApply">
                                <script id="navApply" type="text/html">
                                    {{each list value}}
                                        <label><input type="checkbox" name="" class="qkj-checkbox" {{if value.checked}}checked{{/if}}>{{value.name}}</label>
                                    {{/each}}
                                </script>
                            </dd>
                        </dl>
                        <div class="panel panel-default">
                            <div class="panel-heading">导航设置</div>
                            <div class="panel-body js-nav-set">
                                <script id="navSet" type="text/html">
                                    <div class="form-horizontal nav-color">
                                        {{each colors value i}}
                                        <div class="form-group">
                                            <label class="control-label">{{value.name}}</label>
                                            <div class="control-input">
                                                <div class="dropdown-m js-colorpicker-title" data-value="{{i}}">
                                                    <a href="javascript:;" class="dropdown-switch js-DropdownBt-title">
                                                        <span class="js-bt-label" style="background-color:{{value.color}}">{{value.color}}</span>
                                                        </a>
                                                    <ul class="dropdown-data js-dropdownList-title"></ul>
                                                </div>
                                            </div>
                                        </div>
                                        {{/each}}
                                    </div>

                                    <div class="nav-con">
                                        <div class="form-horizontal ui-sortable">
                                            {{each list value i}}
                                            <div class="nav-item" data-index="{{i}}">
                                                <div class="form-group">
                                                    <label class="control-label">导航名称</label>
                                                    <div class="control-input">
                                                        <input type="text" class="form-control js-nav-title" value="{{value.title}}" maxlength="5" {{if !value.isClose}}disabled{{/if}}>
                                                        <div class="mt5 clearfix">
                                                            <div class="text-center add-pic-btn">
                                                                <a href="javascript:;" id="imgBtn_{{i}}_0"></a>
                                                                <div class="img"><img src="{{value.src}}" alt="" id="img_{{i}}_0"></div>
                                                                <div class="name">未选中图标</div>
                                                                <input type="hidden" id="imgHidden_{{i}}_0">
                                                            </div>
                                                            <div class="text-center add-pic-btn">
                                                                <a href="javascript:;" id="imgBtn_{{i}}_1"></a>
                                                                <div class="img"><img src="{{value.srcSelect}}" alt="" id="img_{{i}}_1"></div>
                                                                <div class="name">选中图标</div>
                                                                <input type="hidden" id="imgHidden_{{i}}_1">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label">链接</label>
                                                    <div class="control-input">
                                                        <select class="form-control js-linkSelect-nav" {{if !value.isClose}}disabled{{/if}} data-index="{{value.linkIndex}}"></select>
                                                        <div class="mt5" {{if value.linkIndex !="" && "6" == value.linkIndex}}style="display:block"{{else}}style="display:none"{{/if}}>
                                                            <input type="text" size="9" class="form-control-inline" {{if value.inputValue}}value="{{value.inputValue}}{{/if}}">
                                                            <a href="javascript:;" class="ml5 js-banner-sure">确定</a>
                                                        </div>
                                                        <div class="link-select" {{if value.linkIndex == "7" || value.linkIndex == "8" || value.linkIndex == "9"}}style="display:inline-block"{{else}}style="display:none"{{/if}}>
                                                            <a href="#modalHomePage" data-toggle="modal" class="link js-link-select-nav">
                                                                <span>{{if value.linkIndex=="7"}}商城页面{{else if value.linkIndex == "8"}}商品{{else if value.linkIndex == "9"}}商品分组{{/if}}</span> | <span class="span_{{value.checkedId}}">{{value.inputValue}}</span>
                                                            </a>
                                                            <a href="javascript:;" class="close close-bg js-del">×</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                {{if value.isClose}}<a href="javascript:;" class="close close-bg js-nav-item-del">×</a>{{/if}}
                                            </div>
                                            {{/each}}
                                        </div>
                                        <a href="javascript:;" class="nav-add js-nav-add"><i class="icon-plus"></i> 添加导航</a>
                                    </div>
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="hidden" value="" id="content" name="content">
                <!--<input type="hidden" value="" id="mallDataId">-->
                <div class="text-center mt20">
                    <button type="button" class="btn btn-primary" id="mallSetBtn">保存</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="../../../js/function/mall/common/main.js"></script>
<script src="../../../js/common/template_common.js"></script>
<script src="../../../js/function/mall/page_set/nav_add.js"></script>

<script>
    $(function () {
        //模板
        new tpl_index({
            tpl_preview:'.js-regions',  //左边模板位置
            tpl_form: '.js-regions-form', //右边模板位置
//            data_l: {
//                bgColor: "#ccc",
//                list: [
//                    {
//                        "title": '首页',
//                        "src1": '../img/icon001.png',
//                        "src2": '../img/icon002.png',
//                        "url": '',
//                        "selected": true,
//                        "textColor":'#f00'
//                    },
//                    {
//                        "title": '购物车',
//                        "src1": '../img/icon003.png',
//                        "src2": '../img/icon004.png',
//                        "url": '',
//                        "selected": false,
//                        "textColor":'#fff'
//                    }
//                ]
//            },
            data: [
                {
                    "type" :'navApply',
                    "list":[
                        {
                            "name": "商城主页",
                            "index": "/mall/home/home",
                            "checked": true
                        },
                        {
                            "name": "会员主页",
                            "index": "/member/home/index",
                            "checked": false
                        },
                        {
                            "name": "商城页面",
                            "index": "/mall/home/home",
                            "checked": true
                        },
                        {
                            "name": "分组页面",
                            "index": "/mall/home/group",
                            "checked": true
                        },
                        {
                            "name": "全部商品",
                            "index": "/mall/goods/list",
                            "checked": true
                        },
                        {
                            "name": "商品搜索",
                            "index": "/mall/goods/search-list",
                            "checked": true
                        }
                    ]
                },
                {
                    "type": 'navSet',
                    "colors": [
                        {
                            "name":"背景颜色",
                            "color":"#eee"
                        },
                        {
                            "name":"文字颜色",
                            "color":"#000"
                        },
                        {
                            "name":"选择文字颜色",
                            "color":"#f00"
                        }
                    ],
                    "list": [
                        {
                            "title": '首页',
                            "src": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/home.png',
                            "srcSelect": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/home-active.png',
                            "url": '',
                            "selected": true,
                            "isClose" : false,
                            "linkIndex": 1,
                            "inputValue": 'http://www.qinguanjia.com',
                            "checkedId": '3'
                        },
                        {
                            "title": '全部商品',
                            "src": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/shop.png',
                            "srcSelect": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/shop-active.png',
                            "url": '',
                            "selected": false,
                            "isClose" : true,
                            "linkIndex": 9,
                            "inputValue": 'fasdfasfasdfas',
                            "checkedId": '1010'
                        },
                        {
                            "title": '购物车',
                            "src": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/cart.png',
                            "srcSelect": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/cart-active.png',
                            "url": '',
                            "selected": false,
                            "isClose" : false,
                            "linkIndex": 3,
                            "inputValue": 'http://www.qinguanjia.com',
                            "checkedId": '3'
                        },
                        {
                            "title": '我的',
                            "src": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/user.png',
                            "srcSelect": 'https://uploadmaster.qinguanjia.com/images/page_set_nav/source/user-active.png',
                            "url": '',
                            "selected": false,
                            "isClose" : false,
                            "linkIndex": 2,
                            "inputValue": '',
                            "checkedId": ''
                        }
                    ]
                }
            ],
            uploadParam:{
                upload_url: 'http://upload.qinguanjia.com/upload.php', //上传路径
                url_img: 'http://www.qinguanjia.com/', //图片路径,
                imageType: '*.jpg;*.png;*.jpeg;',
                formData: { 'folder' : 'page_set'}
            }
        });

        //按钮提交
        $("#mallSetBtn").click(function () {
            var data = [];
            $(".hiddenData").each(function (i,o) {
                data.push(JSON.parse($(o).val()))
            });

            //如果验证通过，则赋值
            if(isValidateNav(data)){
                $("#content").val(JSON.stringify(data));
            }
        });

    });
</script>

<!--商城页面选择-->
<div class="modal fade" id="modalHomePage">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">
                    选择商城页面
                </h4>
            </div>
            <div class="modal-body">
                <div class="table-responsive overflow-y">
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th width="20"></th>
                            <th>页面名称</th>
                            <th>创建时间</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><input type="radio" name="ckMall" class="qkj-radio" value="2"></td>
                            <td><div id="input_2">商品名称1商品名称1商品名称1</div></td>
                            <td>2017-08-07<br>22:47:22</td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="ckMall" class="qkj-radio" value="3"></td>
                            <td><div id="input_3">商品名称2</div></td>
                            <td>2017-08-07<br>22:47:22</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnHomePage"  data-dismiss="modal">保存</button>
            </div>
        </div>
    </div>
</div>

<!--商品选择-->
<div class="modal fade" id="modalGoodsSale">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">
                    选择商品
                </h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal form-search">
                    <div class="row">
                        <div class="form-group col-md-4">
                            <label class="control-label">选择分组</label>
                            <div class="control-input">
                                <select class="form-control">
                                    <option value="1">分组1</option>
                                    <option value="2">分组2</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-md-4">
                            <label class="control-label">商品名称</label>
                            <div class="control-input">
                                <input type="text" class="form-control"  placeholder="">
                            </div>
                        </div>
                        <div class="btn-wrap-pos">
                            <button type="submit" class="btn btn-blue">搜索</button>
                        </div>
                    </div>
                </form>
                <div class="table-responsive overflow-y">
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th width="20"></th>
                            <th width="35%">商品</th>
                            <th>库存</th>
                            <th>创建时间</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><input type="radio" name="ckShop" class="qkj-radio" value="10"></td>
                            <td>
                                <div class="col-xs-3 p0">
                                    <img src="../../../img/qrcode_default.jpg" class="w48">
                                </div>
                                <div class="col-xs-9 p0">
                                    <p id="shopInput_10">商品名称1</p>
                                    <div class="text-danger">￥9.99</div>
                                </div>
                            </td>
                            <td>10</td>
                            <td>2017-08-07<br>22:47:22</td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="ckShop" class="qkj-radio" value="1"></td>
                            <td>
                                <div class="col-xs-3 p0">
                                    <img src="../../../img/qrcode_default.jpg" class="w48">
                                </div>
                                <div class="col-xs-9 p0">
                                    <p id="shopInput_1">商品名称1</p>
                                    <div class="text-danger">￥9.99</div>
                                </div>
                            </td>
                            <td>10</td>
                            <td>2017-08-07<br>22:47:22</td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="ckShop" class="qkj-radio" value="20"></td>
                            <td>
                                <div class="col-xs-3 p0">
                                    <img src="../../../img/qrcode_default.jpg" class="w48">
                                </div>
                                <div class="col-xs-9 p0">
                                    <p id="shopInput_20">商品名称1</p>
                                    <div class="text-danger">￥9.99</div>
                                </div>
                            </td>
                            <td>10</td>
                            <td>2017-08-07<br>22:47:22</td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="ckShop" class="qkj-radio" value="afadsfas"></td>
                            <td>
                                <div class="col-xs-3 p0">
                                    <img src="../../../img/qrcode_default.jpg" class="w48">
                                </div>
                                <div class="col-xs-9 p0">
                                    <p id="shopInput_afadsfas">商品名称1</p>
                                    <div class="text-danger">￥9.99</div>
                                </div>
                            </td>
                            <td>10</td>
                            <td>2017-08-07<br>22:47:22</td>
                        </tr>
                        </tbody>
                    </table>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnGoodsSale"  data-dismiss="modal">保存</button>
            </div>
        </div>
    </div>
</div>

<!--商品分组选择-->
<div class="modal fade" id="modalGroupPage">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">
                    选择分组页面
                </h4>
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th width="20"></th>
                            <th>分组名称</th>
                            <th>创建时间</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><input type="radio" name="ckGroup" class="qkj-radio" value="1010"></td>
                            <td><div id="group_1010">分组名称1</div></td>
                            <td>2017-08-07<br>22:47:22</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnGroupPage"  data-dismiss="modal">保存</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>